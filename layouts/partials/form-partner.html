<section>

  <div class="footer__cta">
    <form class="contact-form" id="contact-form" method="POST">
        <div class="row justify-content-center">
            <div class="form-field col-sm">
                <input id="name" class="input-text js-input" placeholder=" " name="name" type="text" required>
                <label class="label" for="name">Name*</label>
            </div>
            <div class="form-field col-sm">
                <input id="email" class="input-text js-input" placeholder=" " name="email" type="email" required>
                <label class="label" for="email">E-mail*</label>
            </div>
            <div class="form-field col-sm">
                <input id="phoneNumber" class="input-text js-input" placeholder=" " name="phone" type="tel" minlength="10" maxlength="12" required>
                <label class="label" for="phone">Phone*</label>
            </div>

            <!-- Consent Checkbox -->
            <div class="form-field col-md">
                <input type="hidden" name="partner" value="{{ .Params.Name }}">
            </div>
            <div class="form-field col-lg-12">
                <div class="form-field col-lg">
                    <label class="label" for="consent">
                        <input id="consent" type="checkbox" required>
                        I consent to being contacted by an authorized Vivint representative for a free quote.
                    </label>
                </div>
                <p>
                    <button id="send-button" class="submit-btn" type="submit" disabled>Submit</button>
                </p>
                <p id="contact-form-status" class="mt-3" style="display: none;">Form Submitted</p>
            </div>
        </div>
    </form>
</div>

<script>
    const consentCheckbox = document.getElementById('consent');
    const submitButton = document.getElementById('send-button');
    const contactForm = document.getElementById('contact-form');
    const statusMessage = document.getElementById('contact-form-status');

    // Enable submit button when consent is checked
    consentCheckbox.addEventListener('change', () => {
        submitButton.disabled = !consentCheckbox.checked;
    });

    // Handle form submission via Ajax
    contactForm.addEventListener('submit', (event) => {
        event.preventDefault(); // Prevent the form from submitting the default way

        const formData = new FormData(contactForm); // Create a FormData object
        const formDataJSON = Object.fromEntries(formData.entries()); // Convert to a plain object

        submitButton.textContent = 'Submitting...';
        submitButton.disabled = true; // Disable the button

        fetch('https://submit-form.com/Sv32P1mD', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formDataJSON)
        })
        .then(response => {
            if (response.ok) {
                // Show success message
                statusMessage.textContent = 'Form Submitted Successfully!';
                statusMessage.style.display = 'block';
                contactForm.reset(); // Reset the form
                consentCheckbox.checked = false; // Uncheck the consent box
            } else {
                // Show error message
                statusMessage.textContent = 'Submission failed. Please try again.';
                statusMessage.style.display = 'block';
            }
            submitButton.textContent = 'Submit';
            submitButton.disabled = false; // Re-enable the button
        })
        .catch(error => {
            console.error('Error:', error);
            statusMessage.textContent = 'An error occurred. Please try again.';
            statusMessage.style.display = 'block';
            submitButton.textContent = 'Submit';
            submitButton.disabled = false; // Re-enable the button
        });
    });
</script>

